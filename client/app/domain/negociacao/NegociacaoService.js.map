{"version":3,"sources":["../../../app-src/domain/negociacao/NegociacaoService.js"],"names":["HttpService","Negociacao","ApplicationException","NegociacaoService","constructor","_http","obtemNegociacoesDaSemana","get","then","negociacoes","map","obj","Date","data","quantidade","valor","err","obtemNegociacoesDaSemanaAnterior","obtemNegociacoesDaSemanaRetrasada","obtemNegociacoesNoPeriodo","periodo","Promise","all","reduce","novoArray","item","concat","sort","a","b","getTime","console","log"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,uB,sBAAAA,W;;AACAC,sB,iBAAAA,U;;AACAC,gC,+BAAAA,oB;;;AAEF,kBAAMC,iBAAN,CAAwB;;AAE3BC,8BAAc;AACV,yBAAKC,KAAL,GAAa,IAAIL,WAAJ,EAAb;AACH;;AAEDM,2CAA2B;AACvB,2BAAO,KAAKD,KAAL,CAAWE,GAAX,CAAe,oBAAf,EAAqCC,IAArC,CACHC,eAAeA,YAAYC,GAAZ,CAAgBC,OAAO,IAAIV,UAAJ,CAAe,IAAIW,IAAJ,CAASD,IAAIE,IAAb,CAAf,EAAmCF,IAAIG,UAAvC,EAAmDH,IAAII,KAAvD,CAAvB,CADZ,EAEHC,OAAO;AACH,8BAAM,IAAId,oBAAJ,CAAyB,kDAAzB,CAAN;AACH,qBAJE,CAAP;AAMH;;AAEDe,mDAAmC;AAC/B,2BAAO,KAAKZ,KAAL,CAAWE,GAAX,CAAe,sBAAf,EAAuCC,IAAvC,CACHC,eAAeA,YAAYC,GAAZ,CAAgBC,OAAO,IAAIV,UAAJ,CAAe,IAAIW,IAAJ,CAASD,IAAIE,IAAb,CAAf,EAAmCF,IAAIG,UAAvC,EAAmDH,IAAII,KAAvD,CAAvB,CADZ,EAEHC,OAAO;AACH,8BAAM,IAAId,oBAAJ,CAAyB,2DAAzB,CAAN;AACH,qBAJE,CAAP;AAMH;;AAEDgB,oDAAoC;AAChC,2BAAO,KAAKb,KAAL,CAAWE,GAAX,CAAe,uBAAf,EAAwCC,IAAxC,CACHC,eAAeA,YAAYC,GAAZ,CAAgBC,OAAO,IAAIV,UAAJ,CAAe,IAAIW,IAAJ,CAASD,IAAIE,IAAb,CAAf,EAAmCF,IAAIG,UAAvC,EAAmDH,IAAII,KAAvD,CAAvB,CADZ,EAEHC,OAAO;AACH,8BAAM,IAAId,oBAAJ,CAAyB,4DAAzB,CAAN;AACH,qBAJE,CAAP;AAMH;;AAEKiB,yCAAN,GAAkC;AAAA;;AAAA;AAC9B,4BAAI;AACA,gCAAIC,UAAU,MAAMC,QAAQC,GAAR,CAAY,CAC5B,MAAKhB,wBAAL,EAD4B,EAE5B,MAAKW,gCAAL,EAF4B,EAG5B,MAAKC,iCAAL,EAH4B,CAAZ,CAApB;AAKA,mCAAOE,QACFG,MADE,CACK,UAACC,SAAD,EAAYC,IAAZ;AAAA,uCAAqBD,UAAUE,MAAV,CAAiBD,IAAjB,CAArB;AAAA,6BADL,EACkD,EADlD,EAEFE,IAFE,CAEG,UAACC,CAAD,EAAIC,CAAJ;AAAA,uCAAUA,EAAEhB,IAAF,CAAOiB,OAAP,KAAmBF,EAAEf,IAAF,CAAOiB,OAAP,EAA7B;AAAA,6BAFH,CAAP;AAGH,yBATD,CASE,OAAMd,GAAN,EAAW;AACTe,oCAAQC,GAAR,CAAYhB,GAAZ;AACA,kCAAM,IAAId,oBAAJ,CAAyB,mDAAzB,CAAN;AACH;AAb6B;AAcjC;AA/C0B","file":"NegociacaoService.js","sourcesContent":["import { HttpService } from '../../util/HttpService.js';\nimport { Negociacao } from './Negociacao.js';\nimport { ApplicationException } from '../../util/ApplicationException.js';\n\nexport class NegociacaoService {\n\n    constructor() {\n        this._http = new HttpService();\n    }\n\n    obtemNegociacoesDaSemana() {\n        return this._http.get('negociacoes/semana').then(\n            negociacoes => negociacoes.map(obj => new Negociacao(new Date(obj.data), obj.quantidade, obj.valor)),\n            err => {\n                throw new ApplicationException('Não foi possível obter as negociações da semana.');\n            }\n        );\n    }\n\n    obtemNegociacoesDaSemanaAnterior() {\n        return this._http.get('negociacoes/anterior').then(\n            negociacoes => negociacoes.map(obj => new Negociacao(new Date(obj.data), obj.quantidade, obj.valor)),\n            err => {\n                throw new ApplicationException('Não foi possível obter as negociações da semana anterior.');\n            }\n        );\n    }\n\n    obtemNegociacoesDaSemanaRetrasada() {\n        return this._http.get('negociacoes/retrasada').then(\n            negociacoes => negociacoes.map(obj => new Negociacao(new Date(obj.data), obj.quantidade, obj.valor)),\n            err => {\n                throw new ApplicationException('Não foi possível obter as negociações da semana retrasada.');\n            }\n        );\n    }\n\n    async obtemNegociacoesNoPeriodo() {\n        try {\n            let periodo = await Promise.all([\n                this.obtemNegociacoesDaSemana(),\n                this.obtemNegociacoesDaSemanaAnterior(),\n                this.obtemNegociacoesDaSemanaRetrasada()\n            ]);\n            return periodo\n                .reduce((novoArray, item) => novoArray.concat(item), [])\n                .sort((a, b) => b.data.getTime() - a.data.getTime());\n        } catch(err) {\n            console.log(err);\n            throw new ApplicationException('Não foi possível obter as negociações do período.');\n        };\n    }\n}"]}